
<!DOCTYPE html>
<html lang="vi" class="dark">
<head>
  <meta charset="UTF-8" />
  <title>Dá»‹ch ÃŠâ€‘Ä‘Ãª â†” Viá»‡t + Giáº£i Ä‘á» + áº¢nh</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @font-face {
      font-family: 'CharisSIL';
      src: url('https://cdn.jsdelivr.net/gh/silnrsi/font-charis@main/web/CharisSIL-Regular.woff2') format('woff2');
    }
    body { font-family: 'CharisSIL', serif; }
  </style>
</head>
<body class="dark:bg-gray-900 dark:text-white text-black bg-white p-6">
  <div class="max-w-3xl mx-auto space-y-6">

    <h1 class="text-3xl font-bold text-center">ğŸ“˜ Tá»« Ä‘iá»ƒn ÃŠâ€‘Ä‘Ãª â†” Viá»‡t</h1>
    <p class="text-center text-gray-400 text-sm">Tra tá»«, giáº£i Ä‘á», nháº­n diá»‡n hÃ¬nh áº£nh vÃ  giá»ng nÃ³i</p>

    <!-- Tra tá»« -->
    <section class="space-y-2">
      <h2 class="text-xl font-semibold">ğŸ” Dá»‹ch tá»«</h2>
      <input id="inputText" placeholder="Nháº­p tá»« tiáº¿ng Viá»‡t hoáº·c ÃŠâ€‘Ä‘Ãª..." class="w-full p-2 rounded bg-gray-100 dark:bg-gray-800" />
      <div class="flex gap-2">
        <button onclick="translate()" class="px-4 py-1 bg-blue-600 text-white rounded">Dá»‹ch</button>
        <button onclick="startVoice()" class="px-4 py-1 bg-green-600 text-white rounded">ğŸ™ï¸ NÃ³i</button>
      </div>
      <textarea id="outputText" rows="2" class="w-full mt-2 p-2 bg-gray-200 dark:bg-gray-700 rounded" readonly></textarea>
      <div id="exampleText" class="text-sm italic text-green-400"></div>
    </section>

    <!-- OCR dá»‹ch -->
    <section class="space-y-2">
      <h2 class="text-xl font-semibold">ğŸ“· Dá»‹ch tá»« áº£nh</h2>
      <input type="file" accept="image/*" onchange="handleOCR(this.files, false)" />
      <pre id="ocrOutput" class="bg-gray-100 dark:bg-gray-800 p-2 rounded text-sm"></pre>
    </section>

    <!-- OCR giáº£i Ä‘á» -->
    <section class="space-y-2">
      <h2 class="text-xl font-semibold">ğŸ“˜ Giáº£i Ä‘á» bÃ i tá»« áº£nh</h2>
      <input type="file" accept="image/*" onchange="handleOCR(this.files, true)" />
      <div id="solveOutput" class="bg-gray-100 dark:bg-gray-800 p-2 rounded text-sm whitespace-pre-wrap"></div>
    </section>

    <footer class="pt-6 text-center text-xs text-gray-400">
      Â© PhÃ¡t triá»ƒn bá»Ÿi Tháº¿ Báº±ng 2025 â€“ DÃ nh cho giÃ¡o dá»¥c
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>
  <script>
    const dict = {
      "abÄƒ": { vi: "cha", example: "abÄƒ Ä‘hÃ´ng: cha tÃ´i" },
      "abÄƒn": { vi: "xoa dá»‹u", example: "abÄƒn anak: dá»— con" },
      "amÃ¢o": { vi: "lá»­a", example: "amÃ¢o kÆ¡tÃ´: lá»­a chÃ¡y" },
      "cha": { ede: "abÄƒ", example: "cha hiá»n lÃ nh" },
      "xoa dá»‹u": { ede: "abÄƒn", example: "máº¹ xoa dá»‹u Ä‘á»©a bÃ©" },
      "lá»­a": { ede: "amÃ¢o", example: "lá»­a bá»‘c lÃªn cao" }
    };

    function translate() {
      const input = document.getElementById("inputText").value.trim().toLowerCase();
      const out = dict[input];
      let result = "", ex = "";
      if (out?.vi) { result = out.vi; ex = out.example; }
      else if (out?.ede) { result = out.ede; ex = out.example; }
      else { result = "(ChÆ°a cÃ³ trong tá»« Ä‘iá»ƒn)"; ex = ""; }
      document.getElementById("outputText").value = result;
      document.getElementById("exampleText").innerText = ex ? "VÃ­ dá»¥: " + ex : "";
    }

    function handleOCR(files, isSolve = false) {
      const textContainer = isSolve ? document.getElementById("solveOutput") : document.getElementById("ocrOutput");
      textContainer.textContent = "â³ Äang xá»­ lÃ½ áº£nh...";
      Tesseract.recognize(files[0], 'vie', { logger: m => console.log(m) }).then(({ data: { text } }) => {
        const clean = text.trim();
        if (!isSolve) {
          document.getElementById("inputText").value = clean;
          translate();
        } else {
          textContainer.innerText = "ğŸ“ Äá» bÃ i: " + clean + "\n\nğŸ§  Tráº£ lá»i: " + solvePrompt(clean);
        }
      });
    }

    function solvePrompt(text) {
      const lower = text.toLowerCase();
      if (/tá»•ng|cá»™ng|phÃ©p cá»™ng/.test(lower)) {
        const match = lower.match(/(\d+)[^\d]+(\d+)/);
        if (match) return `Káº¿t quáº£ lÃ  ${parseInt(match[1]) + parseInt(match[2])}.`;
      }
      if (/viáº¿t Ä‘oáº¡n|viáº¿t vÄƒn/.test(lower) || lower.length > 30) {
        return "Gia Ä‘Ã¬nh lÃ  nÆ¡i ta sinh ra vÃ  lá»›n lÃªn. Má»i ngÆ°á»i trong gia Ä‘Ã¬nh yÃªu thÆ°Æ¡ng nhau...";
      }
      return "ğŸ¤– ChÆ°a rÃµ Ä‘á» bÃ i. HÃ£y thá»­ nháº­p Ä‘á» cá»¥ thá»ƒ hÆ¡n.";
    }

    function startVoice() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'vi-VN';
      recognition.onresult = function(event) {
        const spoken = event.results[0][0].transcript;
        document.getElementById("inputText").value = spoken;
        translate();
      };
      recognition.onerror = function() {
        alert("KhÃ´ng nháº­n Ä‘Æ°á»£c giá»ng nÃ³i. HÃ£y thá»­ láº¡i!");
      };
      recognition.start();
    }
  </script>
</body>
</html>
